@page
@model ProjectSWP392.Pages.CartPage.Index
@{

    Layout = "~/Pages/Shared/_Layout_Product.cshtml";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
    body {
        background: #eee;
    }
     .all-orders {
        overflow: hidden;
        height: 360px;

    }

    .all-orders::-webkit-scrollbar-thumb {
        background-color: #746c6b;
        border-radius: 6px;
    }

    .all-orders:hover {
        overflow-y: scroll;
    }
        .d-flex{
        gap: 2rem;
    }
    p.mb-2 {
    width: 6rem;
}
p.mb {
    width: 26rem;
    height: auto;
}
.row{
    margin-right: 0rem!important;
    margin-left: 0rem!important;
}
</style>

<h5 style="    margin-bottom: 1rem;
    text-align: center;
    font-weight: 800;
    font-size: 33px;
    margin-top: 2rem;">Shopping Cart</h5>
<section class="h-100 h-custom">
    <div class="container py-5 h-100" style=" padding-top: 0rem!important;">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col" style="padding: 2rem;">
                <div class="card shadow">
                    <div class="card-body p-4">
                        <div class="row">
                            <div class="col-lg-7">
                                <h5 class="mb-3"><a href="#!" class="text-body">Continue shopping</a></h5>
                                <hr>
                                <div class="all-orders">
                                    <table class="table table-bordered " style="   position: sticky; top: 0;z-index: 1; ">
                                        <thead >
                                            <tr style="background: #c49a68;
                                                text-align: center;">
                                                <th style="word-break: break-all;width: 8.8rem;">Product Name</th>
                                                <th style="       width: 11.8rem;">Product Image</th>
                                                <th style=" width: 17.1rem;border: 0px;">Product Quantity</th>
                                                <th style=" width: 7.3rem;">Price</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                    </table>
                                    @if (Model.CartItems != null && Model.CartItems.Any())
                                    {
                                        @foreach (var item in Model.CartItems)
                                        {
                                            <table class="table table-bordered">
                                                <div class="flat-card mb-3">
                                                    <div class="ms-3 me-5">
                                                        <td class="justify-content-center text-center"
                                                            style="word-break: break-all;width: 10.5rem;">
                                                            @item.ProductName</td>
                                                    </div>
                                                    <td class="justify-content-center text-center"
                                                        style="width: 15rem;   height: 8rem;">
                                                        <img src="~/image/@item.ProductImage" alt="@item.ProductName"
                                                            class="img-fluid rounded-1" alt="Shopping item"
                                                            style="width: 158px;" />
                                                    </td>
                                                    <div class="d-flex flex-row align-items-center justify-content-center">
                                                        <div style="width: 50px;">
                                                            <td class="fw-normal mb-0 justify-content-center text-center"
                                                                style=" width: 17rem;padding-top: 3rem;display: flex;flex-direction: row;gap: 1rem;border: 0px;">
                                                                <a style="text-align: center;border-radius: 5rem;background: #c49a68;width: 2rem;height: 2rem;padding-top: 0.3rem !important;color: black;padding-bottom: 0px !important;padding-left: 0px !important;padding-right: 0px !important;"
                                                                    class="spinner-button shadow p-2" asp-page-handler="Sub"
                                                                    asp-page="Index" asp-route-id="@item.CartId">
                                                                    <i class="fa-solid fa-minus me-2"></i>
                                                                </a>
                                                                <p
                                                                    style="    margin-bottom: 0rem !important; margin-top: 0.3rem;">
                                                                    @item.CartQuantity</p>
                                                                <a style="text-align: center;border-radius: 5rem;background: #c49a68;width: 2rem;height: 2rem;padding-top: 0.3rem !important;color: black;padding-bottom: 0px !important;padding-left: 0px !important;padding-right: 0px !important;"
                                                                    class="spinner-button shadow p-2" asp-page-handler="Plus"
                                                                    asp-page="Index" asp-route-id="@item.CartId">
                                                                    <i class="fa-solid fa-plus ms-2"></i>
                                                                </a>
                                                            </td>
                                                        </div>
                                                        <div style="width: 80px;">
                                                            <td class="mb-0 justify-content-center text-center"
                                                                style="width: 8rem;">$@item.Price</td>
                                                        </div>
                                                        <td class="justify-content-center text-center">
                                                            <a class="btn btn-danger btn-sm text-end" asp-page-handler="Delete"
                                                                asp-page="Index" asp-route-id="@item.CartId">
                                                                <i class="fa-regular fa-trash-can"></i>
                                                            </a>
                                                        </td>
                                                    </div>

                                            </table>
                                        }

                                    }
                                    else
                                    {
                                        <p>Your cart is empty.</p>
                                    }
                                </div>
                            </div>
                            <div class="col-lg-5">
                                <div class="card text-white rounded-3 bg-secondary">
                                    <div class="card-body shadow">
                                        <div class="d-flex justify-content-between align-items-center mb-4">
                                            <h5 class="mb-0 text-light">Card details</h5>
                                        </div>
                                        @if (Model.CartItems != null && Model.CartItems.Any())
                                        {
                                            <hr class="my-4">

                                            <div class="d-flex">
                                                <p class="mb-2 text-light">Total Items: </p>
                                                <p class="mb">@Model.CartItems.Count</p>
                                            </div>

                                            <div class="d-flex">
                                                <p class="mb-2 text-light">Total Price: </p>
                                                <p class="mb">@Model.CartItems.Sum(item => item.Price)</p>
                                            </div>

                                            <button type="button" class="btn btn-lg" style="background-color: #009D63;">
                                                <div class="d-flex justify-content-between">
                                                    <a class="text-light" asp-page="/OrderPage/CheckOut">CheckOut</a>
                                                </div>
                                            </button>

                                        }
                                        else
                                        {
                                            <p>Your cart is empty.</p>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
</section>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
@if (@TempData["end"] != null)
{
    <text>
        <script>
            // Check for TempData value and show SweetAlert
            document.addEventListener('DOMContentLoaded', function () {
                Swal.fire({
                    title: 'Warning!',
                    text: 'The product was not enough!',
                    icon: 'warning'
                });
            });
        </script>
    </text>
}